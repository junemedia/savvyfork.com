function updateCaptchas(){var a=document.getElementsByName("captcha"),b=$$("input.sicaptcha"),c=icaptchaURI+"plugins/captcha/securimage/lib/show.php?"+"random="+Math.random()+"."+Math.random();for(var d=0;d<a.length;d++)a[d].src=c,b[d].set("value","")}function validateSICaptcha(a){var b=icaptchaURI+"plugins/captcha/securimage/lib/verify_json.php?securimage_namespace="+a.get("id"),c=(new Request.JSON({url:b,onSuccess:function(b){icaptchaValidator=document.id(a.get("id")+"-validation");if(b.action=="success"){a.removeClass("invalid"),a.addClass("success"),a.set("aria-invalid","false"),icaptchaValidator.set("value",1),parentForm=a.getParent("form");if(parentForm){var c=new Form.Validator.Inline(parentForm);c.validateField(a)}}else icaptchaValid=!1,a.removeClass("success"),a.addClass("invalid"),a.set("aria-invalid","true"),icaptchaValidator.set("value",0)}})).get({captcha_code:a.get("value")})}window.addEvent("domready",function(){var a=document.id("icaptchaUseAjax");a&&a.get("value")==1&&(Array.each($$("input.sicaptcha"),function(a,b){a.addEvent("blur",function(){validateSICaptcha(a)}),a.addEvent("keydown",function(b){b.key=="enter"&&(validateSICaptcha(a),b.stop())})}),Form.Validator.add("sicaptcha",{errorMsg:Joomla.JText._("PLG_CAPTCHA_SECURIMAGE_VALIDATION_CODE_WRONG"),test:function(a){return a.value.length<1?!1:(icaptchaValidator=document.id(a.id+"-validation"),icaptchaValidator.get("value")==0?(validateSICaptcha(a),!1):!0)}}))})